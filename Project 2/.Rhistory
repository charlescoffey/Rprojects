gop_income_n = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = length)
gop_income_share = gop_income_vote/gop_income_n
barplot(gop_income_share, names.arg= names(gop_income_share), ylim = c(0, 0.6))
points(c(1:length(gop_income_share)), gop_income_share, pch = 16, cex = 2, ylim = c(0, 0.6))
lines(c(1:length(gop_income_share)), gop_income_share)
MA_subset = cces_2012[cces_2012$state_abb == "MA", c("vote_gop", "income")]
WI_subset = cces_2012[cces_2012$state_abb == "WI", c("vote_gop", "income")]
MS_subset = cces_2012[cces_2012$state_abb == "MS", c("vote_gop", "income")]
plot(0,
type = 'n',
xlim = c(1, 5),
ylim = c(0, 1),
main = "Income level and Support within states",
xlab = "Income level",
ylab = "Support for GOP",
cex.lab = 1.2)
abline(lm(MA_subset), col="blue", lty = 1, lwd = 4)
abline(lm(WI_subset), col=" purple", lty = 2, lwd = 4)
abline(lm(MS_subset), col="red", lty = 3, lwd = 4)
legend("topleft",
legend = c("MA", "WI", "MS"),
lwd = c(1.5,1.5,1.5),
lty = 1:3,
cex = 0.9,
col = c("blue", "purple", "red"),
bty = "n")
state_average_values = data.frame()
state_average_values = rbind(state_average_values, colMeans(MA_subset), colMeans(WI_subset), colMeans(MS_subset))
names(state_average_values) = c("gop_vote_mean", "income_mean")
#state_average_values[order(state_average_values$gop_vote_mean, decreasing = TRUE),]
points(state_average_values[,2], state_average_values[,1], pch = 16, cex = 2)
lines(state_average_values[,2], state_average_values[,1], lwd = 4)
MA_corr = cor(MA_subset$income, MA_subset$vote_gop)
MS_corr = cor(MS_subset$income, MS_subset$vote_gop)
print(paste("MA indv. income to indv. support for GOP candidate correlation coefficient: ", toString(MA_corr)))
print(paste("MS indv. income to indv. support for GOP candidate correlation coefficient: ", toString(MS_corr)))
dim(br_subset)
dim(br)
used_control_matches_unique
used_control_matches
control_unit_idxs
length(control_unit_idxs)
length(used_control_matches)
length(used_control_matches_unique)
length(not_used_controls)
1144-381
not_used_controls
gop_income_share
gop_income_vote = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = sum)
gop_income_n = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = length)
gop_income_share = gop_income_vote/gop_income_n
barplot(gop_income_share, ylim = c(0, 0.6))
points(c(1:length(gop_income_share)), gop_income_share, pch = 16, cex = 2, ylim = c(0, 0.6))
lines(c(1:length(gop_income_share)), gop_income_share)
?points()
View(mean_differences_std)
View(mean_differences_combined)
View(mean_differences_std)
View(mean_differences_std_match)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = concat(mean_differences_std, mean_differences_std_match)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_std, aes(y=mean_diff, x=var)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
?ggplot()
MA_subset
View(MA_subset)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_std_combined, aes(y=c(mean_diff, mean_diff_matched), x=var)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(y=c(mean_diff, mean_diff_matched), x=var)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(y=mean_diff_matched, x=var)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(y=mean_diff, x=var)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
ggplot(mean_differences_combined, aes(y=mean_diff_matched, x=var))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var)) + geom_line(aes(y=mean_diff)) + geom_line(aes(y=mean_diff_matched)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), aes(x=var, y= mean_diff_matched)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + ggplot(mean_differences_combined, aes(x=var, y = mean_diff_matched)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(mean_diff_matched) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched)) + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), color="red") + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=2) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), color="red") + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), color="red") + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), col="red") + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), col="blue") + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
cces_2012 <- read.csv("cces_2012.csv")
#this could be done in one step by just setting the function to mean
gop_state_vote = tapply(cces_2012$vote_gop, INDEX = cces_2012$state_abb, FUN = sum)
gop_state_n = tapply(cces_2012$vote_gop, INDEX = cces_2012$state_abb, FUN = length)
gop_state_share = gop_state_vote/gop_state_n
income_state = tapply(cces_2012$income, INDEX = cces_2012$state_abb, FUN=mean)
plot(income_state, gop_state_share, ylim = c(0, 0.8), "n",
main = "Mean State Income vs GOP State Share",
ylab = "GOP State Share",
xlab = "Mean Income")
text(income_state, gop_state_share, names(gop_state_share), col="red", cex = 0.65)
abline(lm(gop_state_share ~ income_state))
gop_income_vote = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = sum)
gop_income_n = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = length)
gop_income_share = gop_income_vote/gop_income_n
barplot(gop_income_share, names.arg= names(gop_income_share), ylim = c(0, 0.6),
main = "GOP Income Share vs Income",
xlab = "Income Level",
ylab = "Gop State Share")
points(c(1:length(gop_income_share)), gop_income_share, pch = 16, cex = 2, ylim = c(0, 0.6))
lines(c(1:length(gop_income_share)), gop_income_share)
gop_income_vote = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = sum)
gop_income_n = tapply(cces_2012$vote_gop, INDEX = cces_2012$income, FUN = length)
gop_income_share = gop_income_vote/gop_income_n
barplot(gop_income_share, names.arg= names(gop_income_share), ylim = c(0, 0.6),
main = "GOP Income Share vs Income",
xlab = "Income Level",
ylab = "GOP State Share")
points(c(1:length(gop_income_share)), gop_income_share, pch = 16, cex = 2, ylim = c(0, 0.6))
lines(c(1:length(gop_income_share)), gop_income_share)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff) + geom_point(aes(y=mean_diff_matched)), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff) + geom_point(aes(y=mean_diff_matched)), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched)), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff), col="blue") + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
mean_differences_combined$group = c(1:6)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
mean_differences_combined$group = c(1:6)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, group = group)) + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
mean_differences_combined$group = c(1,2,3,1,2,3)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
mean_differences_combined$group = c(1,2,3,1,2,3)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, group = group)) + geom_point(aes(y=mean_diff_matched), col = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
View(br)
print(paste("The Average Treatment Effect on the Treated Units is:", toString(ATT)))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), col = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point() + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), col = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "red")) + geom_point(aes(y=mean_diff_matched), col = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, color = "red")) + geom_point(aes(y=mean_diff_matched), col = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, color = "red")) + geom_point(aes(y=mean_diff_matched), color = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, color = "black")) + geom_point(aes(y=mean_diff_matched), color = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "black")) + geom_point(aes(y=mean_diff_matched), color = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "pink")) + geom_point(aes(y=mean_diff_matched), color = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "orange")) + geom_point(aes(y=mean_diff_matched), color = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "green")) + geom_point(aes(y=mean_diff_matched), color = "blue") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "green")) + geom_point(aes(y=mean_diff_matched), color = "black") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = "red")) + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff, colour = factor(cyl))) + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff) + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contain just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)]))
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)])
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means before Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
View(MS_subset)
View(state_average_values)
used_control_matches_unique = unique(used_control_matches)
not_used_controls = control_unit_idxs[!control_unit_idxs %in% used_control_matches_unique ]
br_subset = br[-not_used_controls,] #this subset contains just the treated values and controls used for matching
std_match = colSds(as.matrix(br_subset[,3:ncol(br_subset)])) #std of treated and matched controls
control_means_match = colMeans(br_subset[br_subset$treat == 0,3:ncol(br_subset)]) #means of all matched control units
mean_differences_std_match = data.frame((treated_means-control_means_match)/std_match) #standardized mean differences after matching
names(mean_differences_std_match) = "mean_diff_matched"
mean_differences_combined = cbind(mean_differences_std, mean_differences_std_match)
#plot old differences before and after matching
ggplot(mean_differences_combined, aes(x=var, y = mean_diff)) + geom_point(aes(y=mean_diff_matched), color = "green") + geom_hline(yintercept=0) + geom_point(size=1.5) + coord_flip() + ylab("Standardized Difference in Means") + xlab("Covariates") + ggtitle("Standardized Differences in Means after Matching") + theme(plot.title = element_text(size = 14, hjust = 0.5), axis.title=element_text(size=14))
#intitialization of mahalonobis function
MDist <- function(X, idx1, idx2){
x1 = X[idx1,]
x2 = X[idx2,]
vcov = var(X)
dist = sqrt(t(x1-x2) %*% solve(vcov) %*% (x1-x2))
return(dist)
}
source('~/Documents/MIT courses/YEAR3DOCUMENTS/17.835/PSETs/P2/CharlesCoffey17835PSET2.R', echo=TRUE)
get(wd)
getwd()
setwd("~/Documents/MIT courses/YEAR3DOCUMENTS/17.835/PSETs/P2")
source('~/Documents/MIT courses/YEAR3DOCUMENTS/17.835/PSETs/P2/CharlesCoffey17835PSET2.R', echo=TRUE)
quit
quit()
